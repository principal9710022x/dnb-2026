<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">

<!-- Correction mobile indispensable -->
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Simulateur DNB ‚Äì Bulletin officiel</title>

<style>
/* ================= BASE ================= */
body{
  font-family: Arial, Helvetica, sans-serif;
  background:#f4f6f8;
  padding:20px;
}
h1,h2{text-align:center}

table{
  border-collapse:collapse;
  margin:10px auto;
  background:#fff;
}
th,td{
  border:1px solid #000;
  padding:6px 8px;
  text-align:center;
}
th{background:#e6e6e6}

/* Correction mobile : largeur flexible */
.range{
  width:240px;
  max-width:100%;
}

.val{display:inline-block;width:50px;font-weight:bold}
.result{background:#e8f5e9;font-weight:bold}

.trimestre-select{
  text-align:center;
  margin-bottom:12px;
}
.trimestre-select label{
  margin:0 12px;
  font-weight:bold;
}

.actions{text-align:center;margin:25px 0}

/* ===== Comment utiliser ===== */
.info-box{
  border:2px solid #000;
  padding:15px;
  margin:20px auto;
  background:#fafafa;
  max-width:900px;
}

/* ================= PIED DE PAGE ================= */
footer{
  text-align:center;
  font-size:13px;
  font-weight:bold;
  margin-top:35px;
}

/* ================= RESPONSIVE ================= */
@media(max-width:800px){
  table{font-size:14px}
  .range{width:200px}
}

/* ================= IMPRESSION / PDF ================= */
@media print{

  body{
    background:#fff;
    padding:6mm;
    font-size:9.5pt;
  }

  h1{
    font-size:14pt;
    margin:4px 0 6px;
  }

  h2{
    font-size:11pt;
    margin:6px 0 4px;
  }

  table{
    width:100%;
    margin:6px 0;
    font-size:9pt;
  }

  th, td{
    padding:3px 4px;
  }

  .range{
    width:130px;
  }

  .val{
    display:inline;
    font-size:9pt;
    font-weight:normal;
  }

  input[type=range],
  button,
  .actions,
  .info-box,
  .trimestre-select{
    display:none !important;
  }

  footer{
    position:fixed;
    bottom:5mm;
    left:0;
    right:0;
    font-size:9pt;
  }

  table, tr, td, th{
    page-break-inside:avoid !important;
  }

  *{
    box-sizing:border-box;
  }
}

@page{
  size:A4 portrait;
  margin:10mm;
}
</style>
</head>

<body>

<h1>üìò Bulletin de simulation ‚Äì Dipl√¥me National du Brevet</h1>

<h2>üìö Contr√¥le continu ‚Äì 3 trimestres</h2>

<div class="trimestre-select">
  <label><input type="radio" name="tri" value="0" checked> Trimestre 1</label>
  <label><input type="radio" name="tri" value="1"> Trimestre 2</label>
  <label><input type="radio" name="tri" value="2"> Trimestre 3</label>
</div>

<table>
<tr>
  <th>Mati√®re</th>
  <th>Note / 20</th>
  <th>Moyenne annuelle</th>
</tr>
<tbody id="cc"></tbody>
<tr>
  <th colspan="2">Contr√¥le continu ‚Äì base</th>
  <th id="cc_base" class="result"></th>
</tr>
</table>

<h2>üéì √âpreuve facultative</h2>

<table>
<tr><th>Note / 20</th><th>Bonus appliqu√©</th></tr>
<tr>
<td>
<input type="range" min="0" max="20" step="0.1" value="0" id="fac" class="range">
<span class="val" id="vfac">0.0</span>
</td>
<td id="bonus" class="result">0.0</td>
</tr>
</table>

<h2>üìù √âpreuves terminales</h2>

<table>
<tr><th>√âpreuve</th><th>Note / 20</th></tr>
<tbody id="epreuves"></tbody>
<tr>
<th>Moyenne des √©preuves</th>
<th id="moyE" class="result"></th>
</tr>
</table>

<h2>üèÜ R√©sultat final</h2>

<table>
<tr><th>Moyenne finale DNB</th><th id="final" class="result"></th></tr>
<tr><th>D√©cision</th><th id="decision" class="result"></th></tr>
<tr><th>Mention</th><th id="mention" class="result"></th></tr>
</table>

<div class="actions">
<button onclick="window.print()">üìÑ Exporter en PDF</button>
</div>

<div class="info-box">
<strong>Comment utiliser le simulateur ?</strong>
<p>
Renseigne les notes trimestrielles et les √©preuves finales
pour estimer ta moyenne et ta mention au DNB.
</p>
<ul>
<li>Contr√¥le continu : 40 %</li>
<li>√âpreuves terminales : 60 %</li>
<li>Bonus facultatif possible</li>
</ul>
<p><em>R√©sultat indicatif, sans valeur officielle.</em></p>
</div>

<footer id="footer"></footer>

<script>
/* ============================
   CONFIGURATION
============================ */
const matieres=[
 "Fran√ßais","Math√©matiques","Histoire-GG",
 "Langue vivante","Sciences","Technologie",
 "Arts plastiques","√âducation musicale","EPS"
];
const epreuves=[
 "Fran√ßais","Math√©matiques","Histoire-GG",
 "Sciences","Oral"
];

let trimestreActif=0;
const notesCC=matieres.map(()=>[10,10,10]);

/* ============================
   TABLEAU CC
============================ */
const cc=document.getElementById("cc");
matieres.forEach((m,i)=>{
 cc.insertAdjacentHTML("beforeend",`
 <tr>
  <td>${m}</td>
  <td>
    <input type="range" min="0" max="20" step="0.1"
      value="10" class="range cc-range" data-i="${i}">
    <span class="val">10.0</span>
  </td>
  <td id="m${i}" class="result"></td>
 </tr>`);
});

/* ============================
   TRIMESTRE
============================ */
document.querySelectorAll("input[name=tri]").forEach(r=>{
 r.addEventListener("change",()=>{
   trimestreActif=Number(r.value);
   updateCCUI();
 });
});

function updateCCUI(){
 document.querySelectorAll(".cc-range").forEach(sl=>{
   const i=Number(sl.dataset.i);
   sl.value=notesCC[i][trimestreActif];
   sl.nextElementSibling.textContent=Number(sl.value).toFixed(1);
 });
 calc();
}

/* ============================
   √âPREUVES TERMINALES
============================ */
const ep=document.getElementById("epreuves");
epreuves.forEach((e,i)=>{
 ep.insertAdjacentHTML("beforeend",`
 <tr>
  <td>${e}</td>
  <td>
    <input type="range" min="0" max="20" step="0.1"
      value="10" id="e${i}" class="range">
    <span class="val" id="ve${i}">10.0</span>
  </td>
 </tr>`);
});

/* ============================
   SLIDERS ‚Äì FIX MOBILE
============================ */
function bindSliders(){
 document.querySelectorAll("input[type=range]").forEach(r=>{

   const update=()=>{
     const val=Number(r.value || 0);
     const span=r.nextElementSibling;
     if(span) span.textContent=val.toFixed(1);

     if(r.classList.contains("cc-range")){
       const i=Number(r.dataset.i);
       notesCC[i][trimestreActif]=val;
     }

     calc();
   };

   r.addEventListener("input",update);
   r.addEventListener("change",update);
 });
}
bindSliders();

/* ============================
   CALCULS
============================ */
function calc(){
 let totalCC=0;

 matieres.forEach((_,i)=>{
   let moy=(notesCC[i][0]+notesCC[i][1]+notesCC[i][2])/3;
   document.getElementById("m"+i).textContent=moy.toFixed(1);
   totalCC+=moy;
 });

 let CC_base=totalCC/matieres.length;
 document.getElementById("cc_base").textContent=CC_base.toFixed(1);

 let fac=Number(document.getElementById("fac").value || 0);
 document.getElementById("vfac").textContent=fac.toFixed(1);
 let bonus=Math.max(0,fac-10)/20;
 document.getElementById("bonus").textContent=bonus.toFixed(1);

 let totalE=0;
 epreuves.forEach((_,i)=>{
   let v=Number(document.getElementById("e"+i).value || 0);
   document.getElementById("ve"+i).textContent=v.toFixed(1);
   totalE+=v;
 });

 let moyE=totalE/epreuves.length;
 document.getElementById("moyE").textContent=moyE.toFixed(1);

 let final=((CC_base+bonus)*0.4)+(moyE*0.6);
 document.getElementById("final").textContent=final.toFixed(1);

 document.getElementById("decision").textContent=
   final>=10?"ADMIS":"NON ADMIS";

 let mention="‚Äî";
 if(final>=16) mention="Tr√®s Bien";
 else if(final>=14) mention="Bien";
 else if(final>=12) mention="Assez Bien";
 else if(final>=10) mention="Admis (sans mention)";
 document.getElementById("mention").textContent=mention;

 const d=new Date();
 const y=d.getFullYear();
 const m=d.getMonth();
 const annee=(m>=8)?`${y}-${y+1}`:`${y-1}-${y}`;
 document.getElementById("footer").textContent=
   `Simulateur propos√© par Alexis PIMPIT | ${annee}`;
}

calc();
</script>

</body>
</html>